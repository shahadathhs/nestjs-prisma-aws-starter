# Minimal local backup container
FROM alpine:3.18

# Install only what we need
RUN apk add --no-cache bash gzip tar findutils postgresql-client

# Create directories
RUN mkdir -p /backups /scripts

# Copy backup scripts
COPY scripts/backup-database.sh /scripts/backup-database.sh
COPY scripts/restore-database.sh /scripts/restore-database.sh

# Make scripts executable
RUN chmod +x /scripts/backup-database.sh /scripts/restore-database.sh

# Set working directory
WORKDIR /scripts

# Expose backup volume
VOLUME ["/backups"]

# Default command: run backup script (manual or via docker-compose loop)
CMD ["bash", "/scripts/backup-database.sh"]
